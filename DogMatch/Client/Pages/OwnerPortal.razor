@page "/OwnerPortal"
@using Microsoft.AspNetCore.Authorization
@using DogMatch.Client.Services
@using DogMatch.Client.Components.Dog

@attribute [Authorize]
@inject DogState state
@inject NavigationService navigate

<MatH2>Owner Portal</MatH2>
<br />

<AuthorizeView>
    <Authorized>
        <MatH6>Your active Dog Profiles: @state.OwnersDogs?.Count()</MatH6>
        <br />
        <MatH5>My Doggos</MatH5>
        <br />
        <DogsList Dogs="state.OwnersDogs" />
    </Authorized>
</AuthorizeView>

@code {
    protected override async Task OnInitializedAsync()
    {
        await state.GetOwnersDoggos();
        state.OnChange += RefreshComponent;
    }

    private void RefreshComponent() => StateHasChanged();
}